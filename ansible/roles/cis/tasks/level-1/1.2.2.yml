# Standards: 0.11
---

# 1.2.2 Ensure GPG keys are configured

# The remediation actions for this recommendation are site-specific, therefore we test that
# executing the specified rpm command results in no errors.
- name: '1.2.2 - Ensure GPG keys are configured"
  shell: rpm -q gpg-pubkey --qf '%{name}-%{version}-%{release} --> %{summary}\n'
  tags:
    - level-1
    - "1.2.2"
    - scored
  when: ansible_os_family == "Amazon"

- name: "1.2.2 - Ensure GPG keys are configured"
  become: true
  apt:
    name: "{{ item }}"
    state: present
    update_cache: yes
    cache_valid_time: 86400
  with_items:
    - gnupg2
  when: ansible_os_family == "Debian" or ansible_os_family == 'Ubuntu'
